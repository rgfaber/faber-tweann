<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 650">
  <defs>
    <linearGradient id="hebbianGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="ojaGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="selfModGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9C27B0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6A1B9A;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="neuromodGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E65100;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="neuronBg" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="650" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#333">
    Neural Plasticity: Online Weight Learning During Lifetime
  </text>
  <text x="450" y="55" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#666">
    Synaptic plasticity allows networks to adapt during evaluation, not just through evolution
  </text>

  <!-- === HEBBIAN LEARNING (Top Left) === -->
  <rect x="30" y="75" width="410" height="180" rx="10" fill="white" stroke="#4CAF50" stroke-width="2" filter="url(#shadow)"/>
  <rect x="30" y="75" width="410" height="35" rx="10" fill="url(#hebbianGrad)"/>
  <rect x="30" y="100" width="410" height="10" fill="url(#hebbianGrad)"/>
  <text x="235" y="100" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Hebbian Learning: "Cells that fire together, wire together"
  </text>

  <!-- Hebbian formula -->
  <text x="235" y="140" font-family="monospace" font-size="14" text-anchor="middle" fill="#333">
    Δw = η · x · y
  </text>

  <!-- Hebbian diagram -->
  <circle cx="100" cy="190" r="20" fill="url(#neuronBg)" stroke="#4CAF50" stroke-width="2"/>
  <text x="100" y="195" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Pre</text>
  <text x="100" y="225" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">x = 0.8</text>

  <circle cx="280" cy="190" r="20" fill="url(#neuronBg)" stroke="#4CAF50" stroke-width="2"/>
  <text x="280" y="195" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Post</text>
  <text x="280" y="225" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#666">y = 0.6</text>

  <line x1="120" y1="190" x2="258" y2="190" stroke="#4CAF50" stroke-width="3"/>
  <text x="190" y="180" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#4CAF50">w strengthens</text>

  <!-- Explanation -->
  <text x="350" y="150" font-family="Arial, sans-serif" font-size="10" fill="#666">η = learning rate</text>
  <text x="350" y="165" font-family="Arial, sans-serif" font-size="10" fill="#666">x = presynaptic</text>
  <text x="350" y="180" font-family="Arial, sans-serif" font-size="10" fill="#666">y = postsynaptic</text>

  <text x="235" y="245" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#888">
    Problem: Weights grow unbounded (runaway potentiation)
  </text>

  <!-- === OJA'S RULE (Top Right) === -->
  <rect x="460" y="75" width="420" height="180" rx="10" fill="white" stroke="#2196F3" stroke-width="2" filter="url(#shadow)"/>
  <rect x="460" y="75" width="420" height="35" rx="10" fill="url(#ojaGrad)"/>
  <rect x="460" y="100" width="420" height="10" fill="url(#ojaGrad)"/>
  <text x="670" y="100" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Oja's Rule: Normalized Hebbian (Self-Limiting)
  </text>

  <!-- Oja formula -->
  <text x="670" y="145" font-family="monospace" font-size="14" text-anchor="middle" fill="#333">
    Δw = η · y · (x - y · w)
  </text>

  <!-- Oja diagram -->
  <circle cx="530" cy="195" r="20" fill="url(#neuronBg)" stroke="#2196F3" stroke-width="2"/>
  <text x="530" y="200" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Pre</text>

  <circle cx="710" cy="195" r="20" fill="url(#neuronBg)" stroke="#2196F3" stroke-width="2"/>
  <text x="710" y="200" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Post</text>

  <line x1="550" y1="195" x2="688" y2="195" stroke="#2196F3" stroke-width="2"/>
  <path d="M 710 175 Q 750 160 750 195 Q 750 230 710 215" stroke="#2196F3" stroke-width="1.5" fill="none" stroke-dasharray="3,2"/>
  <text x="770" y="195" font-family="Arial, sans-serif" font-size="9" fill="#2196F3">decay</text>

  <!-- Explanation -->
  <text x="820" y="150" font-family="Arial, sans-serif" font-size="9" fill="#666">Self-normalizing:</text>
  <text x="820" y="165" font-family="Arial, sans-serif" font-size="9" fill="#666">weights stabilize</text>
  <text x="820" y="180" font-family="Arial, sans-serif" font-size="9" fill="#666">around |w|=1</text>

  <text x="670" y="245" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#888">
    Performs online PCA - extracts principal component
  </text>

  <!-- === SELF-MODULATION (Bottom Left) === -->
  <rect x="30" y="270" width="410" height="185" rx="10" fill="white" stroke="#9C27B0" stroke-width="2" filter="url(#shadow)"/>
  <rect x="30" y="270" width="410" height="35" rx="10" fill="url(#selfModGrad)"/>
  <rect x="30" y="295" width="410" height="10" fill="url(#selfModGrad)"/>
  <text x="235" y="295" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Self-Modulation: Neuron Controls Own Learning
  </text>

  <!-- Self-mod formula -->
  <text x="235" y="335" font-family="monospace" font-size="13" text-anchor="middle" fill="#333">
    Δw = η · A · B · C · D
  </text>

  <!-- Self-mod diagram with modulation -->
  <circle cx="100" cy="395" r="20" fill="url(#neuronBg)" stroke="#9C27B0" stroke-width="2"/>
  <text x="100" y="400" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Pre</text>

  <circle cx="280" cy="395" r="25" fill="url(#neuronBg)" stroke="#9C27B0" stroke-width="2"/>
  <text x="280" y="400" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Post</text>

  <!-- Modulation output -->
  <path d="M 280 370 Q 280 340 320 340" stroke="#9C27B0" stroke-width="2" fill="none"/>
  <circle cx="335" cy="340" r="12" fill="#9C27B0"/>
  <text x="335" y="344" font-family="Arial, sans-serif" font-size="8" text-anchor="middle" fill="white">M</text>
  <text x="380" y="345" font-family="Arial, sans-serif" font-size="9" fill="#9C27B0">modulation</text>

  <line x1="120" y1="395" x2="253" y2="395" stroke="#9C27B0" stroke-width="2"/>

  <!-- Parameter boxes -->
  <rect x="45" y="430" width="50" height="20" rx="3" fill="#f3e5f5" stroke="#9C27B0" stroke-width="1"/>
  <text x="70" y="444" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#9C27B0">A=±1</text>

  <rect x="105" y="430" width="50" height="20" rx="3" fill="#f3e5f5" stroke="#9C27B0" stroke-width="1"/>
  <text x="130" y="444" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#9C27B0">B=x</text>

  <rect x="165" y="430" width="50" height="20" rx="3" fill="#f3e5f5" stroke="#9C27B0" stroke-width="1"/>
  <text x="190" y="444" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#9C27B0">C=y</text>

  <rect x="225" y="430" width="50" height="20" rx="3" fill="#f3e5f5" stroke="#9C27B0" stroke-width="1"/>
  <text x="250" y="444" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#9C27B0">D=w</text>

  <text x="350" y="365" font-family="Arial, sans-serif" font-size="9" fill="#666">Parameters evolve:</text>
  <text x="350" y="380" font-family="Arial, sans-serif" font-size="9" fill="#666">A,B,C,D ∈ {-1,0,1,x,y,w}</text>
  <text x="350" y="395" font-family="Arial, sans-serif" font-size="9" fill="#666">Creates 6⁴ = 1296</text>
  <text x="350" y="410" font-family="Arial, sans-serif" font-size="9" fill="#666">possible rules!</text>

  <!-- === NEUROMODULATION (Bottom Right) === -->
  <rect x="460" y="270" width="420" height="185" rx="10" fill="white" stroke="#FF9800" stroke-width="2" filter="url(#shadow)"/>
  <rect x="460" y="270" width="420" height="35" rx="10" fill="url(#neuromodGrad)"/>
  <rect x="460" y="295" width="420" height="10" fill="url(#neuromodGrad)"/>
  <text x="670" y="295" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Neuromodulation: External Gating Signal
  </text>

  <!-- Neuromod formula -->
  <text x="670" y="335" font-family="monospace" font-size="13" text-anchor="middle" fill="#333">
    Δw = η · m · x · y
  </text>

  <!-- Neuromod diagram -->
  <circle cx="530" cy="395" r="20" fill="url(#neuronBg)" stroke="#FF9800" stroke-width="2"/>
  <text x="530" y="400" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Pre</text>

  <circle cx="710" cy="395" r="20" fill="url(#neuronBg)" stroke="#FF9800" stroke-width="2"/>
  <text x="710" y="400" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#333">Post</text>

  <!-- Modulatory neuron -->
  <circle cx="620" cy="330" r="18" fill="#FF9800"/>
  <text x="620" y="335" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="white">Mod</text>
  <text x="620" y="310" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#FF9800">m signal</text>

  <!-- Modulatory connection -->
  <path d="M 620 348 L 620 375" stroke="#FF9800" stroke-width="2" stroke-dasharray="3,2" marker-end="url(#arrow)"/>

  <line x1="550" y1="395" x2="688" y2="395" stroke="#FF9800" stroke-width="2"/>

  <!-- Explanation -->
  <text x="800" y="340" font-family="Arial, sans-serif" font-size="9" fill="#666">Reward/dopamine</text>
  <text x="800" y="355" font-family="Arial, sans-serif" font-size="9" fill="#666">gates learning</text>
  <text x="800" y="370" font-family="Arial, sans-serif" font-size="9" fill="#666">m=0: no change</text>
  <text x="800" y="385" font-family="Arial, sans-serif" font-size="9" fill="#666">m=1: full update</text>

  <text x="670" y="440" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#888">
    Enables reward-modulated learning (three-factor rule)
  </text>

  <!-- === WEIGHT FORMAT BOX === -->
  <rect x="30" y="470" width="420" height="90" rx="10" fill="white" stroke="#666" stroke-width="1" filter="url(#shadow)"/>
  <text x="240" y="495" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">
    TWEANN Weight Tuple Format
  </text>
  <text x="240" y="520" font-family="monospace" font-size="12" text-anchor="middle" fill="#333">
    {Weight, DeltaWeight, LearningRate, PlasticityParams}
  </text>
  <text x="240" y="545" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">
    Weight carries its own learning parameters - evolves alongside topology
  </text>

  <!-- === PLASTICITY FUNCTIONS BOX === -->
  <rect x="460" y="470" width="420" height="90" rx="10" fill="white" stroke="#666" stroke-width="1" filter="url(#shadow)"/>
  <text x="670" y="495" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">
    Available Plasticity Functions
  </text>
  <text x="510" y="520" font-family="monospace" font-size="10" fill="#4CAF50">none</text>
  <text x="510" y="535" font-family="monospace" font-size="10" fill="#4CAF50">hebbian</text>
  <text x="600" y="520" font-family="monospace" font-size="10" fill="#2196F3">oja</text>
  <text x="600" y="535" font-family="monospace" font-size="10" fill="#2196F3">bcm</text>
  <text x="700" y="520" font-family="monospace" font-size="10" fill="#9C27B0">self_modulation</text>
  <text x="700" y="535" font-family="monospace" font-size="10" fill="#9C27B0">hebbian_a</text>
  <text x="800" y="520" font-family="monospace" font-size="10" fill="#FF9800">neuromod</text>
  <text x="800" y="535" font-family="monospace" font-size="10" fill="#FF9800">stdp</text>

  <!-- Bottom summary -->
  <rect x="30" y="575" width="850" height="60" rx="8" fill="#fff3e0" stroke="#FF9800" stroke-width="1"/>
  <text x="455" y="600" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#E65100">
    Why Plasticity Matters
  </text>
  <text x="455" y="620" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">
    Evolution discovers network topology and initial weights. Plasticity rules allow networks to adapt during their lifetime,
  </text>
  <text x="455" y="635" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">
    enabling meta-learning: networks that learn HOW to learn for their specific task domain.
  </text>
</svg>