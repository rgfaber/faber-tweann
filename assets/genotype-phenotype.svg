<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 550">
  <defs>
    <linearGradient id="genotypeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9C27B0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6A1B9A;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="phenotypeGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="sensorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="actuatorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E65100;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="mnesiaBg" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8f5e9;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#c8e6c9;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="processBg" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e3f2fd;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#bbdefb;stop-opacity:1" />
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.2"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="550" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#333">
    Genotype to Phenotype: From DNA to Living Neural Network
  </text>

  <!-- Genotype Section (Left - Mnesia Storage) -->
  <rect x="30" y="55" width="300" height="420" rx="10" fill="url(#mnesiaBg)" stroke="#4CAF50" stroke-width="2"/>
  <text x="180" y="80" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2E7D32">
    GENOTYPE (Mnesia)
  </text>
  <text x="180" y="98" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Persistent genetic encoding
  </text>

  <!-- Agent Record -->
  <rect x="45" y="110" width="270" height="70" rx="6" fill="white" stroke="#9C27B0" stroke-width="1.5"/>
  <text x="180" y="130" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#9C27B0">
    #agent Record
  </text>
  <text x="55" y="150" font-family="monospace" font-size="9" fill="#333">id: {agent, 0.123}</text>
  <text x="55" y="165" font-family="monospace" font-size="9" fill="#333">cortex_id, sensors, actuators, neurons</text>

  <!-- Cortex Record -->
  <rect x="45" y="190" width="270" height="60" rx="6" fill="white" stroke="#9C27B0" stroke-width="1.5"/>
  <text x="180" y="210" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#9C27B0">
    #cortex Record
  </text>
  <text x="55" y="230" font-family="monospace" font-size="9" fill="#333">id: {cortex, 0.456}, agent_id, sensor_ids, n_ids</text>

  <!-- Sensor Record -->
  <rect x="45" y="260" width="130" height="65" rx="6" fill="white" stroke="#4CAF50" stroke-width="1.5"/>
  <text x="110" y="280" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#4CAF50">
    #sensor
  </text>
  <text x="52" y="298" font-family="monospace" font-size="8" fill="#333">id: {sensor, 0.1}</text>
  <text x="52" y="312" font-family="monospace" font-size="8" fill="#333">name: rng</text>

  <!-- Actuator Record -->
  <rect x="185" y="260" width="130" height="65" rx="6" fill="white" stroke="#FF9800" stroke-width="1.5"/>
  <text x="250" y="280" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="#FF9800">
    #actuator
  </text>
  <text x="192" y="298" font-family="monospace" font-size="8" fill="#333">id: {actuator, 0.9}</text>
  <text x="192" y="312" font-family="monospace" font-size="8" fill="#333">name: pts</text>

  <!-- Neuron Records -->
  <rect x="45" y="335" width="270" height="80" rx="6" fill="white" stroke="#2196F3" stroke-width="1.5"/>
  <text x="180" y="355" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#2196F3">
    #neuron Records
  </text>
  <text x="55" y="375" font-family="monospace" font-size="8" fill="#333">n1: {id, af: tanh, input_ids, output_ids,</text>
  <text x="75" y="390" font-family="monospace" font-size="8" fill="#333">weights: [{w, dw, lr, params}, ...]}</text>
  <text x="55" y="405" font-family="monospace" font-size="8" fill="#333">n2: {id, af: relu, input_ids, ...}</text>

  <!-- Connection Gene List -->
  <rect x="45" y="425" width="270" height="40" rx="6" fill="#f5f5f5" stroke="#666" stroke-width="1"/>
  <text x="180" y="450" font-family="monospace" font-size="9" text-anchor="middle" fill="#666">
    Connection genes with innovation numbers
  </text>

  <!-- Arrow: Genotype to Constructor -->
  <path d="M 335 275 L 395 275" stroke="#666" stroke-width="3" marker-end="url(#arrow)"/>
  <text x="365" y="265" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    constructor
  </text>
  <text x="365" y="290" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#888">
    spawn_agent/1
  </text>

  <!-- Phenotype Section (Right - Running Processes) -->
  <rect x="405" y="55" width="475" height="420" rx="10" fill="url(#processBg)" stroke="#2196F3" stroke-width="2"/>
  <text x="640" y="80" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1565C0">
    PHENOTYPE (Erlang Processes)
  </text>
  <text x="640" y="98" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Living neural network with concurrent neurons
  </text>

  <!-- Exoself Process -->
  <rect x="530" y="110" width="220" height="40" rx="6" fill="#673AB7" filter="url(#shadow)"/>
  <text x="640" y="135" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
    Exoself Process (Supervisor)
  </text>

  <!-- Cortex Process -->
  <rect x="530" y="165" width="220" height="40" rx="6" fill="url(#genotypeGrad)" filter="url(#shadow)"/>
  <text x="640" y="190" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="white">
    Cortex Process (Coordinator)
  </text>

  <!-- Sensor Processes -->
  <rect x="420" y="230" width="100" height="55" rx="6" fill="url(#sensorGrad)" filter="url(#shadow)"/>
  <text x="470" y="250" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">
    Sensor S1
  </text>
  <text x="470" y="270" font-family="monospace" font-size="8" text-anchor="middle" fill="white">
    gen_server
  </text>

  <rect x="420" y="295" width="100" height="55" rx="6" fill="url(#sensorGrad)" filter="url(#shadow)"/>
  <text x="470" y="315" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">
    Sensor S2
  </text>
  <text x="470" y="335" font-family="monospace" font-size="8" text-anchor="middle" fill="white">
    gen_server
  </text>

  <!-- Neuron Processes -->
  <rect x="545" y="230" width="90" height="50" rx="6" fill="url(#phenotypeGrad)" filter="url(#shadow)"/>
  <text x="590" y="252" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">
    Neuron N1
  </text>
  <text x="590" y="268" font-family="monospace" font-size="7" text-anchor="middle" fill="white">
    tanh, plasticity
  </text>

  <rect x="645" y="230" width="90" height="50" rx="6" fill="url(#phenotypeGrad)" filter="url(#shadow)"/>
  <text x="690" y="252" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">
    Neuron N2
  </text>
  <text x="690" y="268" font-family="monospace" font-size="7" text-anchor="middle" fill="white">
    relu, plasticity
  </text>

  <rect x="745" y="230" width="90" height="50" rx="6" fill="url(#phenotypeGrad)" filter="url(#shadow)"/>
  <text x="790" y="252" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">
    Neuron N3
  </text>
  <text x="790" y="268" font-family="monospace" font-size="7" text-anchor="middle" fill="white">
    sigmoid, LTC
  </text>

  <rect x="595" y="295" width="90" height="50" rx="6" fill="url(#phenotypeGrad)" filter="url(#shadow)"/>
  <text x="640" y="317" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">
    Neuron N4
  </text>
  <text x="640" y="333" font-family="monospace" font-size="7" text-anchor="middle" fill="white">
    tanh, plasticity
  </text>

  <rect x="695" y="295" width="90" height="50" rx="6" fill="url(#phenotypeGrad)" filter="url(#shadow)"/>
  <text x="740" y="317" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="white">
    Neuron N5
  </text>
  <text x="740" y="333" font-family="monospace" font-size="7" text-anchor="middle" fill="white">
    CfC neuron
  </text>

  <!-- Actuator Processes -->
  <rect x="770" y="370" width="100" height="55" rx="6" fill="url(#actuatorGrad)" filter="url(#shadow)"/>
  <text x="820" y="390" font-family="Arial, sans-serif" font-size="11" font-weight="bold" text-anchor="middle" fill="white">
    Actuator A1
  </text>
  <text x="820" y="410" font-family="monospace" font-size="8" text-anchor="middle" fill="white">
    gen_server
  </text>

  <!-- Message passing arrows -->
  <line x1="520" y1="255" x2="543" y2="255" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="635" y1="255" x2="643" y2="255" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="735" y1="255" x2="743" y2="255" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="590" y1="280" x2="590" y2="293" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="740" y1="280" x2="740" y2="293" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <line x1="688" y1="320" x2="770" y2="385" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>
  <line x1="787" y1="320" x2="805" y2="368" stroke="#666" stroke-width="1.5" marker-end="url(#arrow)"/>

  <!-- Sync messages to cortex -->
  <path d="M 820 370 Q 850 340 820 205" stroke="#673AB7" stroke-width="1" stroke-dasharray="3,2" fill="none"/>
  <text x="855" y="290" font-family="Arial, sans-serif" font-size="8" fill="#673AB7">sync</text>

  <!-- Process registry note -->
  <rect x="420" y="370" width="170" height="90" rx="6" fill="white" stroke="#ddd" stroke-width="1"/>
  <text x="505" y="390" font-family="Arial, sans-serif" font-size="10" font-weight="bold" text-anchor="middle" fill="#333">
    Process Registry
  </text>
  <text x="430" y="410" font-family="monospace" font-size="8" fill="#666">gproc: {{n,l,{cortex,ID}}, PID}</text>
  <text x="430" y="425" font-family="monospace" font-size="8" fill="#666">gproc: {{n,l,{neuron,ID}}, PID}</text>
  <text x="430" y="440" font-family="monospace" font-size="8" fill="#666">gproc: {{n,l,{sensor,ID}}, PID}</text>
  <text x="430" y="455" font-family="monospace" font-size="8" fill="#666">gproc: {{n,l,{actuator,ID}}, PID}</text>

  <!-- Bottom explanation -->
  <rect x="30" y="485" width="850" height="55" rx="8" fill="white" stroke="#ddd" stroke-width="1"/>
  <text x="455" y="505" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">
    The Constructor Pattern
  </text>
  <text x="455" y="525" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">
    Genotype records in Mnesia are transformed into spawned Erlang processes. Each neuron becomes a concurrent gen_server,
  </text>
  <text x="455" y="540" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#666">
    connected via asynchronous message passing. The Cortex coordinates sync cycles; the Exoself manages lifetime and learning.
  </text>
</svg>