<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="backboneGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#6366f1;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#8b5cf6;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="headGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#34d399;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="sigmoidGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#f59e0b;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#fbbf24;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="stateGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#ec4899;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#f472b6;stop-opacity:1" />
    </linearGradient>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#64748b"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10b981"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="800" height="500" fill="#f8fafc"/>

  <!-- Title -->
  <text x="400" y="30" text-anchor="middle" font-family="system-ui, sans-serif" font-size="20" font-weight="bold" fill="#1e293b">CfC: Closed-form Continuous-time Neural Network</text>
  <text x="400" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#64748b">x(t+dt) = sigma(-f) * x(t) + (1 - sigma(-f)) * h -- 100x faster than ODE</text>

  <!-- Input node -->
  <g transform="translate(60, 160)">
    <circle cx="30" cy="50" r="25" fill="#3b82f6" stroke="#1d4ed8" stroke-width="2" filter="url(#shadow)"/>
    <text x="30" y="47" text-anchor="middle" font-family="monospace" font-size="14" font-weight="bold" fill="white">I(t)</text>
    <text x="30" y="62" text-anchor="middle" font-family="sans-serif" font-size="9" fill="white">input</text>
    <text x="30" y="95" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Input at</text>
    <text x="30" y="107" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">time t</text>
  </g>

  <!-- Previous state -->
  <g transform="translate(60, 280)">
    <circle cx="30" cy="30" r="25" fill="url(#stateGrad)" stroke="#be185d" stroke-width="2" filter="url(#shadow)"/>
    <text x="30" y="27" text-anchor="middle" font-family="monospace" font-size="14" font-weight="bold" fill="white">x(t)</text>
    <text x="30" y="42" text-anchor="middle" font-family="sans-serif" font-size="9" fill="white">state</text>
    <text x="30" y="72" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Previous</text>
    <text x="30" y="84" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">state</text>
  </g>

  <!-- Backbone network f() -->
  <g transform="translate(180, 120)">
    <rect x="0" y="0" width="140" height="100" rx="10" fill="url(#backboneGrad)" stroke="#4f46e5" stroke-width="2" filter="url(#shadow)"/>
    <text x="70" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">Backbone f()</text>
    <text x="70" y="50" text-anchor="middle" font-family="monospace" font-size="11" fill="#e0e7ff">f = W_f * concat(I, x)</text>
    <text x="70" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#c7d2fe">Time constant</text>
    <text x="70" y="85" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#c7d2fe">modulator</text>
  </g>

  <!-- Head network h() -->
  <g transform="translate(180, 250)">
    <rect x="0" y="0" width="140" height="100" rx="10" fill="url(#headGrad)" stroke="#059669" stroke-width="2" filter="url(#shadow)"/>
    <text x="70" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">Head h()</text>
    <text x="70" y="50" text-anchor="middle" font-family="monospace" font-size="11" fill="#d1fae5">h = W_h * concat(I, x)</text>
    <text x="70" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#a7f3d0">Target state</text>
    <text x="70" y="85" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#a7f3d0">proposal</text>
  </g>

  <!-- Arrows to networks -->
  <line x1="110" y1="210" x2="175" y2="170" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="110" y1="210" x2="175" y2="280" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="110" y1="310" x2="175" y2="300" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="110" y1="310" x2="175" y2="190" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)" stroke-dasharray="4,2"/>

  <!-- Sigmoid gate -->
  <g transform="translate(380, 140)">
    <rect x="0" y="0" width="120" height="80" rx="10" fill="url(#sigmoidGrad)" stroke="#d97706" stroke-width="2" filter="url(#shadow)"/>
    <text x="60" y="25" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="bold" fill="white">Sigmoid Gate</text>
    <text x="60" y="50" text-anchor="middle" font-family="monospace" font-size="14" fill="white">sigma(-f)</text>
    <text x="60" y="70" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#fef3c7">Interpolation</text>
  </g>

  <!-- Arrow from backbone to sigmoid -->
  <line x1="320" y1="170" x2="375" y2="175" stroke="#6366f1" stroke-width="2" marker-end="url(#arrowPurple)"/>

  <!-- Mixing operation -->
  <g transform="translate(380, 270)">
    <circle cx="60" cy="40" r="35" fill="#f1f5f9" stroke="#64748b" stroke-width="2" filter="url(#shadow)"/>
    <text x="60" y="35" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#1e293b">Mix</text>
    <text x="60" y="50" text-anchor="middle" font-family="monospace" font-size="10" fill="#475569">sigma*x</text>
    <text x="60" y="62" text-anchor="middle" font-family="monospace" font-size="10" fill="#475569">+(1-sigma)*h</text>
  </g>

  <!-- Arrows to mixing -->
  <path d="M 440 220 L 440 232" fill="none" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="320" y1="300" x2="345" y2="300" stroke="#10b981" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <path d="M 90 310 Q 200 380 380 310" fill="none" stroke="#ec4899" stroke-width="2" stroke-dasharray="4,2" marker-end="url(#arrow)"/>

  <!-- Output state -->
  <g transform="translate(560, 270)">
    <circle cx="40" cy="40" r="35" fill="url(#stateGrad)" stroke="#be185d" stroke-width="3" filter="url(#shadow)"/>
    <text x="40" y="35" text-anchor="middle" font-family="monospace" font-size="13" font-weight="bold" fill="white">x(t+dt)</text>
    <text x="40" y="52" text-anchor="middle" font-family="sans-serif" font-size="9" fill="white">new state</text>
    <text x="40" y="95" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">Updated</text>
    <text x="40" y="107" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#475569">state</text>
  </g>

  <!-- Arrow to output -->
  <line x1="475" y1="310" x2="520" y2="310" stroke="#64748b" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- State feedback loop -->
  <path d="M 600 340 L 600 400 L 90 400 L 90 340" fill="none" stroke="#ec4899" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrow)"/>
  <text x="345" y="420" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#be185d">State persists to next timestep</text>

  <!-- Equation box -->
  <g transform="translate(640, 100)">
    <rect x="0" y="0" width="140" height="150" rx="8" fill="#f1f5f9" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow)"/>
    <text x="70" y="20" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#1e293b">CfC Equation</text>

    <text x="10" y="45" font-family="monospace" font-size="10" fill="#6366f1">x_new =</text>
    <text x="20" y="65" font-family="monospace" font-size="10" fill="#f59e0b">sigma(-f)</text>
    <text x="85" y="65" font-family="monospace" font-size="10" fill="#1e293b">* x</text>
    <text x="20" y="85" font-family="monospace" font-size="10" fill="#1e293b">+</text>
    <text x="30" y="85" font-family="monospace" font-size="10" fill="#f59e0b">(1-sigma)</text>
    <text x="95" y="85" font-family="monospace" font-size="10" fill="#1e293b">* h</text>

    <line x1="10" y1="100" x2="130" y2="100" stroke="#e2e8f0"/>

    <text x="10" y="120" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">sigma near 1: keep x</text>
    <text x="10" y="135" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">sigma near 0: use h</text>
  </g>

  <!-- Benefits box -->
  <g transform="translate(50, 440)">
    <rect x="0" y="0" width="700" height="45" rx="6" fill="#ecfdf5" stroke="#34d399" stroke-width="1"/>
    <text x="20" y="18" font-family="system-ui, sans-serif" font-size="11" font-weight="bold" fill="#059669">Why CfC?</text>
    <text x="100" y="18" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b">100x faster than solving ODE numerically</text>
    <text x="380" y="18" font-family="system-ui, sans-serif" font-size="11" fill="#64748b">|</text>
    <text x="400" y="18" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b">Same expressivity as LTC ODE</text>
    <text x="580" y="18" font-family="system-ui, sans-serif" font-size="11" fill="#64748b">|</text>
    <text x="600" y="18" font-family="system-ui, sans-serif" font-size="11" fill="#1e293b">Production-ready</text>
    <text x="350" y="36" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">Based on Hasani et al. (2022) "Closed-form Continuous-time Neural Networks" - Nature Machine Intelligence</text>
  </g>
</svg>
