<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 600">
  <defs>
    <linearGradient id="sensorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#2E7D32;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hiddenGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1565C0;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="actuatorGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#E65100;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="cortexGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#9C27B0;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#6A1B9A;stop-opacity:1" />
    </linearGradient>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666"/>
    </marker>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="600" fill="#f8f9fa"/>

  <!-- Title -->
  <text x="450" y="35" font-family="Arial, sans-serif" font-size="24" font-weight="bold" text-anchor="middle" fill="#333">
    TWEANN Architecture: Topology and Weight Evolving Neural Network
  </text>

  <!-- Cortex box (coordinator) -->
  <rect x="350" y="55" width="200" height="40" rx="8" fill="url(#cortexGrad)" filter="url(#shadow)"/>
  <text x="450" y="80" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="white">
    Cortex (Coordinator)
  </text>

  <!-- Layer Labels -->
  <text x="120" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2E7D32">
    Sensors
  </text>
  <text x="120" y="150" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    (Input Layer)
  </text>

  <text x="450" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#1565C0">
    Hidden Neurons
  </text>
  <text x="450" y="150" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    (Evolving Topology)
  </text>

  <text x="780" y="130" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#E65100">
    Actuators
  </text>
  <text x="780" y="150" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    (Output Layer)
  </text>

  <!-- Sensor nodes (Input) -->
  <circle cx="120" cy="220" r="30" fill="url(#sensorGrad)" filter="url(#shadow)"/>
  <text x="120" y="225" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">S1</text>

  <circle cx="120" cy="320" r="30" fill="url(#sensorGrad)" filter="url(#shadow)"/>
  <text x="120" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">S2</text>

  <circle cx="120" cy="420" r="30" fill="url(#sensorGrad)" filter="url(#shadow)"/>
  <text x="120" y="425" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">S3</text>

  <!-- Hidden neurons (evolving) -->
  <circle cx="350" cy="200" r="28" fill="url(#hiddenGrad)" filter="url(#shadow)"/>
  <text x="350" y="205" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">H1</text>

  <circle cx="450" cy="280" r="28" fill="url(#hiddenGrad)" filter="url(#shadow)"/>
  <text x="450" y="285" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">H2</text>

  <circle cx="350" cy="360" r="28" fill="url(#hiddenGrad)" filter="url(#shadow)"/>
  <text x="350" y="365" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">H3</text>

  <circle cx="550" cy="320" r="28" fill="url(#hiddenGrad)" filter="url(#shadow)"/>
  <text x="550" y="325" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">H4</text>

  <circle cx="450" cy="420" r="28" fill="url(#hiddenGrad)" filter="url(#shadow)"/>
  <text x="450" y="425" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">H5</text>

  <!-- Dashed circle for potential new neuron -->
  <circle cx="550" cy="200" r="25" fill="none" stroke="#1565C0" stroke-width="2" stroke-dasharray="5,5" opacity="0.5"/>
  <text x="550" y="205" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#1565C0" opacity="0.7">new?</text>

  <!-- Actuator nodes (Output) -->
  <circle cx="780" cy="270" r="30" fill="url(#actuatorGrad)" filter="url(#shadow)"/>
  <text x="780" y="275" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">A1</text>

  <circle cx="780" cy="380" r="30" fill="url(#actuatorGrad)" filter="url(#shadow)"/>
  <text x="780" y="385" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="white">A2</text>

  <!-- Connections with weights -->
  <!-- Sensor to Hidden connections -->
  <line x1="150" y1="220" x2="320" y2="200" stroke="#666" stroke-width="2"/>
  <text x="230" y="200" font-family="monospace" font-size="9" fill="#666">w=0.73</text>

  <line x1="150" y1="220" x2="420" y2="280" stroke="#666" stroke-width="3"/>
  <text x="280" y="240" font-family="monospace" font-size="9" fill="#666">w=1.24</text>

  <line x1="150" y1="320" x2="320" y2="360" stroke="#666" stroke-width="1.5"/>
  <text x="230" y="355" font-family="monospace" font-size="9" fill="#666">w=0.45</text>

  <line x1="150" y1="320" x2="420" y2="280" stroke="#666" stroke-width="2"/>
  <text x="260" y="310" font-family="monospace" font-size="9" fill="#666">w=-0.82</text>

  <line x1="150" y1="420" x2="320" y2="360" stroke="#666" stroke-width="2.5"/>
  <text x="230" y="400" font-family="monospace" font-size="9" fill="#666">w=0.91</text>

  <line x1="150" y1="420" x2="420" y2="420" stroke="#666" stroke-width="1"/>
  <text x="280" y="430" font-family="monospace" font-size="9" fill="#666">w=0.33</text>

  <!-- Hidden to Hidden connections (recurrent topology) -->
  <path d="M 378 200 Q 400 240 478 280" stroke="#1565C0" stroke-width="2" fill="none"/>
  <text x="415" y="225" font-family="monospace" font-size="9" fill="#1565C0">w=0.67</text>

  <path d="M 478 280 Q 520 300 522 320" stroke="#1565C0" stroke-width="1.5" fill="none"/>
  <text x="510" y="295" font-family="monospace" font-size="9" fill="#1565C0">w=-0.51</text>

  <path d="M 378 360 Q 400 400 422 420" stroke="#1565C0" stroke-width="2" fill="none"/>
  <text x="385" y="405" font-family="monospace" font-size="9" fill="#1565C0">w=0.89</text>

  <!-- Dashed potential connection -->
  <path d="M 478 420 Q 510 380 522 320" stroke="#1565C0" stroke-width="1.5" stroke-dasharray="5,3" fill="none" opacity="0.5"/>

  <!-- Hidden to Actuator connections -->
  <line x1="378" y1="200" x2="750" y2="270" stroke="#666" stroke-width="2"/>
  <text x="560" y="225" font-family="monospace" font-size="9" fill="#666">w=1.12</text>

  <line x1="578" y1="320" x2="750" y2="270" stroke="#666" stroke-width="2.5"/>
  <text x="660" y="285" font-family="monospace" font-size="9" fill="#666">w=0.95</text>

  <line x1="578" y1="320" x2="750" y2="380" stroke="#666" stroke-width="1.5"/>
  <text x="660" y="360" font-family="monospace" font-size="9" fill="#666">w=-0.68</text>

  <line x1="478" y1="420" x2="750" y2="380" stroke="#666" stroke-width="2"/>
  <text x="610" y="410" font-family="monospace" font-size="9" fill="#666">w=0.77</text>

  <!-- Legend -->
  <rect x="20" y="480" width="860" height="105" rx="8" fill="white" stroke="#ddd" stroke-width="1"/>
  <text x="450" y="500" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#333">
    TWEANN Key Concepts
  </text>

  <!-- Legend items -->
  <circle cx="60" cy="530" r="12" fill="url(#sensorGrad)"/>
  <text x="80" y="535" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Sensor: Receives environmental input (fixed topology)
  </text>

  <circle cx="360" cy="530" r="12" fill="url(#hiddenGrad)"/>
  <text x="380" y="535" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Hidden Neuron: Processing node (evolving)
  </text>

  <circle cx="660" cy="530" r="12" fill="url(#actuatorGrad)"/>
  <text x="680" y="535" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Actuator: Produces output (fixed)
  </text>

  <line x1="40" y1="560" x2="100" y2="560" stroke="#666" stroke-width="2"/>
  <text x="110" y="565" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Connection with weight (line thickness = |weight|)
  </text>

  <line x1="360" y1="560" x2="420" y2="560" stroke="#1565C0" stroke-width="2" stroke-dasharray="5,3"/>
  <text x="430" y="565" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Potential new connection (mutation)
  </text>

  <circle cx="690" cy="560" r="10" fill="none" stroke="#1565C0" stroke-width="1.5" stroke-dasharray="3,3"/>
  <text x="710" y="565" font-family="Arial, sans-serif" font-size="11" fill="#333">
    Potential new neuron (add_node mutation)
  </text>
</svg>