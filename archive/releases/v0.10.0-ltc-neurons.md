# v0.10.0 - LTC Neurons

## Overview

This release introduces **Liquid Time-Constant (LTC) neurons** to faber-tweann, making it the first TWEANN library with LTC/CfC neuron support in Erlang/OTP. LTC neurons enable adaptive temporal processing with input-dependent time constants.

**Phase**: Feature Release
**Status**: Released (2025-12-03)
**Prerequisites**: v0.9.0 (Library Refactoring complete)

## Objectives

1. Implement LTC and CfC neuron dynamics in pure Erlang
2. Add Rust NIF acceleration for performance-critical evaluation
3. Extend the genotype with LTC-specific neuron fields
4. Add mutation operators for LTC parameters
5. Provide comprehensive documentation and usage guides

## Scientific Background

### Liquid Time-Constant Networks

LTC neurons are based on continuous-time neural dynamics that adapt their behavior based on input signals. The core differential equation:

```
dx/dt = -[1/τ + f(x,I)] · x + f(x,I) · A
```

Where:
- `x(t)` is the internal state
- `τ` (tau) is the base time constant
- `f(x,I)` is the backbone network (modulates time constant)
- `A` is the state bound (prevents explosion)

### Closed-Form Continuous-time (CfC)

CfC provides an analytical solution to the LTC ODE, enabling ~100x faster evaluation:

```
x(t+Δt) = A·sigmoid(backbone) + [x(t) - A·sigmoid(backbone)] · exp(-Δt·[1/τ + backbone])
```

This closed-form solution eliminates numerical integration while preserving the liquid dynamics.

### Academic References

- Hasani, R., Lechner, M., et al. (2021). "Liquid Time-constant Networks." AAAI 2021.
- Hasani, R., Lechner, M., et al. (2022). "Closed-form Continuous-time Neural Networks." Nature Machine Intelligence.

## Implementation

### Core Modules

#### ltc_dynamics.erl (~380 lines)
Core computation engine for LTC and CfC dynamics:
- `evaluate_cfc/4,5` - CfC closed-form evaluation (~100x faster than ODE)
- `evaluate_ode/5,6` - ODE-based evaluation (Euler integration)
- `compute_backbone/3` - Time constant modulation network
- `compute_head/2` - Target state computation
- `compute_liquid_tau/4` - Adaptive time constant calculation
- `clamp_state/2`, `reset_state/0` - State management utilities

#### neuron_ltc.erl (~280 lines)
LTC-specific neuron process with:
- Full process lifecycle with internal state persistence
- CfC and ODE modes supported
- Reset/get state operations
- LTC parameter update support

### Genotype Extensions

Extended `#neuron` record in `records.hrl`:

```erlang
-record(neuron, {
    %% ... existing fields ...
    neuron_type = standard,     % standard | ltc | cfc
    time_constant = 1.0,        % τ - base time constant
    state_bound = 1.0,          % A - prevents state explosion
    ltc_backbone_weights = [],  % f() backbone network weights
    ltc_head_weights = [],      % h() head network weights
    internal_state = 0.0        % x(t) persistent state
}).
```

New type specifications in `types.hrl`:
- `neuron_type()` - standard | ltc | cfc
- `time_constant()` - float() > 0
- `state_bound()` - float() > 0
- `ltc_params()` - map with LTC configuration

### Evolution Support

New mutation operators in `genome_mutator.erl`:
- `mutate_neuron_type/1` - Switch between standard/ltc/cfc
- `mutate_time_constant/1` - Perturb tau
- `mutate_state_bound/1` - Perturb state bound A
- `mutate_ltc_weights/1` - Perturb backbone/head weights

### Rust NIF Acceleration

Optional Rust NIF in `native/src/lib.rs` for high-performance evaluation:
- `evaluate_cfc/4` - Fast CfC evaluation
- `evaluate_cfc_with_weights/6` - CfC with custom weights
- `evaluate_ode/5` - ODE-based evaluation
- `evaluate_cfc_batch/4` - Batch evaluation for time series

## Usage Examples

### Creating an LTC Network

```erlang
%% Create network with LTC hidden neurons
Network = network_evaluator:create_network_with_ltc(
    42,           % Random seed
    [16, 8],      % Hidden layers
    6,            % Output size
    #{
        neuron_type => cfc,
        time_constant => 0.5,
        state_bound => 1.0
    }
).
```

### Evaluating with Temporal Memory

```erlang
%% LTC neurons maintain state across evaluations
Output1 = network_evaluator:evaluate(Network, Input1),
Output2 = network_evaluator:evaluate(Network, Input2),  % Influenced by Input1
Output3 = network_evaluator:evaluate(Network, Input3).  % Influenced by Input1 and Input2

%% Reset state for new sequence
Network2 = network_evaluator:reset_state(Network).
```

### Parameter Tuning

| Parameter | Default | Range | Effect |
|-----------|---------|-------|--------|
| `time_constant` (τ) | 1.0 | 0.01-10.0 | Response speed: lower = faster |
| `state_bound` (A) | 1.0 | 0.1-10.0 | Maximum state magnitude |
| `dt` (time step) | 0.1 | 0.01-1.0 | Integration granularity |

## Documentation Added

### Guides
- **guides/ltc-neurons.md** - Comprehensive LTC concepts guide
- **guides/ltc-usage-guide.md** - Practical usage guide

### Diagrams
- **design_docs/diagrams/ltc-neuron-architecture.svg** - Architecture diagram
- **design_docs/diagrams/ltc-vs-standard-neurons.svg** - Comparison diagram

## Performance Characteristics

- **CfC evaluation**: ~100x faster than ODE integration
- **State bounded dynamics**: Prevents numerical overflow
- **Configurable time constants**: Adapt to different response speeds
- **Memory efficiency**: Single float per neuron for state

## Test Results

- 468 tests passing (including 68 new LTC tests)
  - 45 core dynamics tests
  - 11 mutation operator tests
  - 12 Rust NIF tests
- Dialyzer clean

## Use Cases

LTC neurons are particularly suited for:
1. **Time series processing** - Temporal patterns with varying speeds
2. **Robotics control** - Adaptive motor control
3. **Financial prediction** - Multi-scale temporal patterns
4. **Reinforcement learning** - Credit assignment over time
5. **Meta-learning** - Hyperparameter adaptation (see macula-neuroevolution)

## Future Work

See v0.11.0+ roadmap for planned extensions:
- ONNX export for LTC networks
- Multi-scale temporal processing
- Hierarchical LTC structures

## Dependencies

### External
- Optional: Rust toolchain for NIF compilation

### Internal
- All v0.9.0 modules
- Extended genotype.erl for LTC fields

---

**Version**: 0.10.0
**Phase**: Feature Release
**Status**: Released
